<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="css/homepage.css">
        <link rel="icon" href="favicon.ico">
        <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@1,800&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Nunito&display=swap" rel="stylesheet">
        <title>
            EF 152 Project Alpha
        </title>
    </head>
    <body>
        <div id="chooseRocket_mdl" class="modal">
            <div class="modal-content">
              <div class="modal-header">
                <h2>Select Your Rocket</h2>
              </div>
              <div class="modal-body">
                <p>Choose from one of the 4 themes.</p>
                <p>list of buttons/dot list</p>
                <code>In development</code>
              </div>
              <div class="modal-footer">
                <button id="submitRocket" class="button" style="margin-right: 2%;">Choose Rocket</button>
                <button id="close_btn_1" class="button">Cancel</button>
              </div>
            </div>
        </div>
        <div id="settings_mdl" class="modal">
            <div class="modal-content">
              <div class="modal-header">
                <h2>Change Game Settings</h2>
              </div>
              <div class="modal-body">
                <b>Difficulty:</b> <input type="range" min="0" max="2" class="rangeInput" id="difficulty_input" value="1"> <span id="difficulty_disp">1</span> <br>
                <b>Pillars Per Level:</b> <input type="range" min="12" max="24" class="rangeInput" id="totalPillar_input" value="18"> <span id="totalPillar_disp">18</span> <br>
                <b>Number of Levels:</b> <input type="range" min="1" max="4" class="rangeInput" id="totalLevels_input" value="1"> <span id="totalLevels_disp">1</span> <br>
                <b>Select Mode:</b> <button id="mode_normal" class="button">Normal</button> <button id="time_mode" class="button">Time Trials</button>
                <p><b><i>Be sure to pick your rocket!</i></b></p>
                <code>In development</code>
              </div>
              <div class="modal-footer">
                <button id="submitSettings" class="button" style="margin-right: 2%;">Change Settings</button>
                <button id="close_btn_2" class="button">Cancel</button>
              </div>
            </div>
        </div>
        <div id="startGame_mdl" class="modal">
            <div class="modal-content">
              <div class="modal-header">
                <h2 style="margin-left:-2%;">Welcome!</h2>
              </div>
              <div class="modal-body">
                <p>Welcome to <i>Blast Off!</i> Use the arrow keys to move your rocket, or launch it as a projectile to the next pillar. </p>
                <p>Be sure to choose your favorite rocket!</p>
              </div>
              <div class="modal-footer">
                <button id="startGame_btn" class="button" style="margin-right: 2%;"><b>Start Game</b></button>
              </div>
            </div>
        </div>
        <div id="launchMode_mdl" class="modal" style="top:15%;">
            <div class="modal-content">
              <div class="modal-header">
                <h2>Launch Mode</h2>
              </div>
              <div class="modal-body" style="background-color: rgba(0,0,0, 0.75);">
                V<sub>0</sub> Vel: <input type="range" min="1" max="30" class="rangeInput" id="launchMode_vel_input" value="0"> <span id="launchMode_vel_disp">0</span> u/s <br>
            &theta; from Horizontal: <input type="range" min="45" max="90" class="rangeInput" id="launchMode_vel_angle" value="45"> <span id="launchMode_ang_disp">0</span>&deg; <br>
            Graph Scale: <input type="range" min="10" max="175" class="rangeInput" id="graphZoom" value="100"> <span id="graphZoom_disp">100</span>% <br>

                <canvas id="traplot" style="border:2px solid #f4d160;"></canvas>
              </div>
              <div class="modal-footer">
                <button id="launchMode_btn" class="button" style="margin-right: 2%;"><b>Launch!</b></button>
                <button id="launchMode_close" class="button" style="margin-right: 2%;">Close</button>
              </div>
            </div>
        </div>
        <div class="top-container">
            <h1>Rooftop Rocket</h1>
            <h3 class="links"><a href="how_to_play.html">How To Play</a></h3>
            <h3 class="links"><a href="trajectory_eq.html">Trajectory Equation</a></h3>
        </div>
        <div class="left-container">
            Score: <span id="score">0000</span> <br>
            Pillar Number: <span id="ploc">0000</span> <br>
            Fuel Remaining: <span id="fuel">0000</span> <br>
        </div>
        <div class="middle-container">
            X Pos: <span id="x_pos">X</span> <br>
            Y Pos: <span id="y_pos">Y</span> <br>
            X Dist to Next Pillar: <span id="x_next_pillar">X</span> <br>
            Y Dist to Next Pillar: <span id="y_next_pillar">Y</span> <br>
        </div>
        <div class="right-container">
            V<sub>0</sub> Vel: <input type="range" min="1" max="50" class="rangeInput" id="input_vel" value="0"> <span id="vel_disp">0</span> u/s <br>
            &theta; from Horizontal: <input type="range" min="0" max="90" class="rangeInput" id="vel_angle" value="45"> <span id="ang_disp">0</span>&deg; <br>
            <button id="enableLaunchMode" class="button">Enable Launch Mode</button>
            <button class="button" onclick="velInput()">Launch</button> <br>
        </div>
        <div class="settings-container">
            <button id="chooseRocket_btn" class="button" style="margin-top: 16.5px;">Choose Rocket</button> <br>
            <button id="settings_btn" class="button" style="margin-top: 16.5px;">Settings</button>
            <button id="pause_btn" class="button" style="margin-top: 16.5px;">Pause Game</button>
        </div>
        <br><br>
        <div class="bottom-container">
            <canvas id="cv" style="border:2px solid #f4d160;"></canvas><br><br>
        </div>
        <code>In development</code>
        <script>
            var prohibitNewModal = true;
            window.onload = function() {
                startGame_mdl.classList.add('show');
                startGame_btn.onclick = function() {
                    startGame_mdl.classList.remove('show');
                    console.log("Starting game with selected settings...")
                    setGameState(0,1);
                    prohibitNewModal = false;
                }
            }
        </script>
        <script>
            // Launch mode coordinator
            enableLaunchMode.onclick = function() {
                if (!prohibitNewModal) {
                    launchMode_mdl.classList.add('show');
                    prohibitNewModal = true;
                    if (!paused) {
                        pause();
                        pauseButtonUpdate();
                    }
                }
            }
            launchMode_btn.onclick = function() {
                launchMode_mdl.classList.remove('show');
                prohibitNewModal = false;
                if (paused) {
                    pause();
                    pauseButtonUpdate();
                }
            }
            launchMode_close.onclick = function() {
                launchMode_mdl.classList.remove('show');
                prohibitNewModal = false;
                if (paused) {
                    pause();
                    pauseButtonUpdate();
                }
            }
        </script>
        <script>
            // Handle the rocket and settings modification windows

            var chooseRocket_mdl = document.getElementById("chooseRocket_mdl");
            var settings_mdl = document.getElementById("settings_mdl");

            var chooseRocket_btn = document.getElementById("chooseRocket_btn");
            var settings_btn = document.getElementById("settings_btn");

            var span = document.getElementsByClassName("close")[0];

            // When the user clicks the button, open the modal
            chooseRocket_btn.onclick = function() {
                if (!prohibitNewModal) {
                    chooseRocket_mdl.classList.add('show');
                    prohibitNewModal = true;
                }
            }
            settings_btn.onclick = function() {
                if (!prohibitNewModal) {
                    settings_mdl.classList.add('show');
                    prohibitNewModal = true;
                }
            }
            pause_btn.onclick = function() {
                if (!prohibitNewModal) {
                    pause();
                    pauseButtonUpdate();
                }
            }
            function pauseButtonUpdate() {
                if (paused) {
                    document.getElementById("pause_btn").innerHTML = "Resume Game";
                }
                else {
                    document.getElementById("pause_btn").innerHTML = "Pause Game";
                }
            }

            // Close the modal based on the following conditions
            close_btn_1.onclick = function() {
                chooseRocket_mdl.classList.remove('show');
                prohibitNewModal = false;
            }
            close_btn_2.onclick = function() {
                settings_mdl.classList.remove('show');
                prohibitNewModal = false;
            }

            submitRocket.onclick = function() {
                chooseRocket_mdl.classList.remove('show');
                prohibitNewModal = false;
                console.log("Rocket model chosen. Resetting to previous game state.")
            }
            submitSettings.onclick = function() {
                settings_mdl.classList.remove('show');
                prohibitNewModal = false;
                console.log("Game settings changed. Resetting game state.")
            }

            // When the user clicks anywhere outside of the modal, close it
            window.onclick = function(event) {
                if (event.target == settings_mdl || event.target == chooseRocket_mdl) {
                    chooseRocket_mdl.classList.remove('show');
                    settings_mdl.classList.remove('show');
                    prohibitNewModal = false;
                }
            }
        </script>
        <script src="scripts/matter.min.js" type="text/javascript"></script>
        <script src="scripts/simulation.js" type="text/javascript"></script>
        <script src="scripts/sliderUpdate.js" type="text/javascript"></script>
        <script src="scripts/traplot.js" type="text/javascript"></script>
    </body>
</html>
